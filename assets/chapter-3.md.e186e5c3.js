import{_ as s,c as e,o as a,a as n}from"./app.cb8e3dd8.js";const F=JSON.parse('{"title":"\xC9tape 3 - R\xE9-assemblage \u{1F527}","description":"","frontmatter":{},"headers":[{"level":2,"title":"Configuration des tests","slug":"configuration-des-tests"},{"level":2,"title":"Premiers tests","slug":"premiers-tests"},{"level":2,"title":"Visual testing","slug":"visual-testing"}],"relativePath":"chapter-3.md"}'),l={name:"chapter-3.md"},o=n(`<h1 id="etape-3-re-assemblage-\u{1F527}" tabindex="-1">\xC9tape 3 - R\xE9-assemblage \u{1F527} <a class="header-anchor" href="#etape-3-re-assemblage-\u{1F527}" aria-hidden="true">#</a></h1><p>\u{1F3AF} L&#39;objectif ici est de modifier notre projet pour qu&#39;il utilise l&#39;API de test de playwright.</p><h2 id="configuration-des-tests" tabindex="-1">Configuration des tests <a class="header-anchor" href="#configuration-des-tests" aria-hidden="true">#</a></h2><p>Il est maintenant tant que vous configuriez votre projet pour qu&#39;il puisse lancer des tests automatis\xE9s.</p><p>Pour cela, Playwright met \xE0 disposition un package d\xE9di\xE9 <code>@playwright/test</code>.</p><ul><li>Ajoutez cette d\xE9pendance sur votre projet</li></ul><div class="language-shell"><button class="copy"></button><span class="lang">shell</span><pre><code><span class="line"><span style="color:#A6ACCD;">pnpm install @playwright/test</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># OR</span></span>
<span class="line"><span style="color:#A6ACCD;">npm install @playwright/test</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># OR</span></span>
<span class="line"><span style="color:#A6ACCD;">yarn install @playwright/test</span></span>
<span class="line"></span></code></pre></div><p>Ce package s&#39;appuie sur un fichier de configuration <code>playwright.config.js</code> ou <code>playwright.config.ts</code>.</p><ul><li>Cr\xE9er le fichier de configuration <code>playwright.config.ts</code> avec le contenu suivant :</li></ul><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">PlaywrightTestConfig</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@playwright/test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> config</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PlaywrightTestConfig</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> config</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>En vous appuyant sur <a href="https://playwright.dev/docs/test-configuration." target="_blank" rel="noreferrer">la documentation</a>, configurez-le de la mani\xE8re suivante : <ul><li>D\xE9finissez le dossier source des tests pour qu&#39;il soit <code>./src</code></li><li>D\xE9finissez le dossier de sortie pour qu&#39;il soit <code>./test-results</code></li><li>D\xE9finissez le nombre de re-tentative pour qu&#39;il soit de 1 si <code>p<wbr>rocess.env.CI</code> est d\xE9fini et de 0 sinon</li><li>Cr\xE9er <a href="https://playwright.dev/docs/test-configuration#multiple-browsers" target="_blank" rel="noreferrer">un projet</a> pour chaque navigateur que l&#39;on souhaite tester <code>chromium desktiop</code>, <code>firefox desktop</code>, <code>webkit desktop</code> et <code>Pixel 4</code></li></ul></li></ul><div class="tip custom-block"><p class="custom-block-title">INFO</p><p>\u2139\uFE0F Si vous devez d\xE9marrer un server local, playwright peut s&#39;en occuper pour vous avec l&#39;option <a href="https://playwright.dev/docs/api/class-testconfig#test-config-web-server" target="_blank" rel="noreferrer"><code>webServer</code></a></p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">PlaywrightTestConfig</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@playwright/test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> config</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PlaywrightTestConfig</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">webServer</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">npm run start</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">port</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">timeout</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10000</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">reuseExistingServer</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">env</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">CI</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div></div><h2 id="premiers-tests" tabindex="-1">Premiers tests <a class="header-anchor" href="#premiers-tests" aria-hidden="true">#</a></h2><p>Pour commencer, nous allons v\xE9rifier le titre de la page.</p><ul><li>Cr\xE9ez un fichier de test <code>./src/chapter_3.spec.ts</code></li><li>Ajouter un nouveau test et nommez-le <code>it should have the correct title</code></li></ul><div class="language-typescript"><button class="copy"></button><span class="lang">typescript</span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">test</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">expect</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@playwright/test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">test</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">TODO</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> page</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> browser </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// TODO</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>Naviguez sur <code>https://playwright.dev/</code></li><li>V\xE9rifiez que le titre est bien identique \xE0 <code>Fast and reliable end-to-end testing for modern web apps | Playwright</code>, pour cela vous pouvez utiliser la fonction <a href="https://playwright.dev/docs/test-assertions" target="_blank" rel="noreferrer"><code>expect</code></a> expos\xE9e par <code>@playwright/test</code> qui \xE9tend directement de <a href="https://jestjs.io/" target="_blank" rel="noreferrer">jest</a>!</li></ul><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#82AAFF;">expect</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toEqual</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>Lancez vos tests avec la commande <code>npm run playwright test</code> et v\xE9rifiez qu&#39;ils passent correctement</li></ul><h2 id="visual-testing" tabindex="-1">Visual testing <a class="header-anchor" href="#visual-testing" aria-hidden="true">#</a></h2><p>Playwright permet \xE9galement de faire du <a href="https://playwright.dev/docs/test-snapshots" target="_blank" rel="noreferrer">visual testing</a>.</p><ul><li>Cr\xE9er 2 nouveaux tests <code>it should have the correct screenshot for light mode</code> et <code>it should have the correct screenshot for dark mode</code></li><li>Dans chacun de ces 2 tests, naviguez vers <code>https://playwright.dev/</code></li><li>\xC9mulez le bon <code>colorScheme</code> en fonction du test</li><li>Utilisez <code>await expect(page).toHaveScreenshot( /* options */ );</code> pour faire un screenshot de la page enti\xE8re.</li><li>Pour g\xE9n\xE9rer la premi\xE8re fois vos images, lancez vos tests avec la commande <code>npm run playwright test --update-snapshots</code> et v\xE9rifiez qu&#39;ils sont correctement g\xE9n\xE9r\xE9s.</li><li>Relancer vos tests normalement et v\xE9rifiez qu&#39;ils passent avec la commande <code>npm run playwright test</code></li></ul><p>Nos agents nous informent que la troisi\xE8me phrase qui vous permettra de d\xE9coder les codes secrets de Microsoft est contenue dans votre screenshot du mode dark. Il s&#39;agit de la seconde phrase du premier paragraphe situ\xE9 sous le titre <code>No trade-offs \u2022 No limits</code>.</p><p><strong>Notez-la pr\xE9cieusement</strong> et vous pouvez passer \xE0 la phase 4 du plan !</p>`,24),t=[o];function p(r,c,i,y,d,D){return a(),e("div",null,t)}var C=s(l,[["render",p]]);export{F as __pageData,C as default};
